name: Update changelog
description: Generates a changelog for the given version and fits in into the CHANGELOG.md file
inputs:
  version:
    description: Version number invoked from workflow
    required: true
  token:
    description: GitHub token with access to all necessary repositories
    required: true
runs:
  using: composite
  steps:
  - run: |
      set -e
      # Download the action from the store
      curl --fail -L -o /tmp/update-changelog https://github.com/grafana/grafana-github-actions-go/releases/download/dev/update-changelog
      chmod +x /tmp/update-changelog
      # Execute action
      /tmp/update-changelog --version ${{inputs.version}}
    shell: bash
    env:
      GITHUB_TOKEN: "${{inputs.token}}"
